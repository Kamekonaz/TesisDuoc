<div class="mainView">
    <div class="border-b border-gray-800 shadow-lg w-full h-16 grid select-none" style="grid-template-columns: 200px 0.9fr 1fr;">
        <div class="flex ml-4 mr-auto my-auto space-x-2">
            <i class="m-auto text-gray-200 fa-solid fa-pen-to-square"></i>
            <div class="italic text-white font-bold">Profesionales</div>
        </div>
        <div class="text-gray-200 font-medium flex mr-auto my-auto space-x-4" id="profesionalDisplayOptionContainer">
            <div class="profesionalsDisplayOption px-2 rounded-lg hover:bg-gray-600 bg-gray-800 active" option="1" onclick="toggleProfesionalsDisplay(this)">Todos</div>
            <div class="profesionalsDisplayOption px-2 rounded-lg hover:bg-gray-600" option="2"  onclick="toggleProfesionalsDisplay(this)">Activos</div>
            <div class="profesionalsDisplayOption px-2 rounded-lg hover:bg-gray-600" option="3"  onclick="toggleProfesionalsDisplay(this)">Inactivos</div>
        </div>
        <div class="text-gray-200 font-medium flex space-x-3 ml-auto pr-4">
            <div class="px-3 py-1 rounded-lg bg-green-600 hover:bg-green-700 my-auto">Añadir Profesional</div>
        </div>
    </div>

    <div class="py-2 w-full flex my-auto px-6">
        <input id="profesionalesSearch" class="border rounded-lg h-12 w-full pl-2 text-gray-200 text-xl bg-gray-800 border-gray-900 border-2 focus:border-black focus:outline-none focus:border-3" type="text" placeholder="Buscar"/>
    </div>

    <div class="p-2 text-gray-100 select-none overflow-y-auto" id="profesionalListContainer">

    </div>
</div>

<div class="editView text-white h-full hidden">
    <div class="grid h-full" style="grid-template-rows: 1fr 100px;">
        <div class="flex flex-col" id="profesionalUserID">
            <div class="w-full h-36 grid" style="grid-template-columns: 150px 1fr;">
                <div class="ml-12 m-auto profile-pic flex">
                    <label class="-label bg-gray-200 rounded-full" for="file">
                      <span class="glyphicon glyphicon-camera"></span>
                    </label>
                    <input id="file" type="file" onchange="loadFile(event)"/>
                    <img src="https://cdn.icon-icons.com/icons2/2506/PNG/512/user_icon_150670.png" id="profesionalPFP" width="200" />
                  </div>

                  <div class="flex flex-col">
                    <div class="text-gray-300 italic mt-12 text-xl" id="profesionalRutDisplay">Rut: 11.111.111-1</div>
                    <div class="flex space-x-2">
                        <div class="my-auto">Username:</div>
                        <input id="profesionalUsernameInput" class="pl-2 font-medium border border-gray-900 bg-gray-800 h-8 rounded-lg shadow-lg focus:outline-0 focus:border-black focus:border-2" style="width:150px;" type="text">
                    </div>
                  </div>
                  
            </div>
            
           <div class="grid" style="grid-template-columns:1.4fr 1fr;">
                <div class="flex flex-col space-y-4 ml-12 mt-12">
                    <div class="grid" style="grid-template-columns: 120px 1fr;">
                        <div class="my-auto">Nombres:</div>
                        <input id="profesionalNombresInput" class="pl-2 font-medium border border-gray-900 bg-gray-800 h-10 rounded-lg shadow-lg focus:outline-0 focus:border-black focus:border-2" style="width:300px;" type="text">
                    </div>
                    <div class="grid" style="grid-template-columns: 120px 1fr;">
                        <div class="my-auto">Apellidos:</div>
                        <input id="profesionalApellidosInput" class="pl-2 font-medium border border-gray-900 bg-gray-800 h-10 rounded-lg shadow-lg focus:outline-0 focus:border-black focus:border-2" style="width:300px;" type="text">
                    </div>
                    <div class="grid" style="grid-template-columns: 120px 1fr;">
                        <div class="my-auto">Email:</div>
                        <input id="profesionalEmailInput" class="pl-2 font-medium border border-gray-900 bg-gray-800 h-10 rounded-lg shadow-lg focus:outline-0 focus:border-black focus:border-2" style="width:300px;" type="text">
                    </div>
                    <div class="grid" style="grid-template-columns: 120px 1fr;">
                        <div class="my-auto">Telefono:</div>
                        <input id="profesionalTelefonoInput" class="pl-2 font-medium border border-gray-900 bg-gray-800 h-10 rounded-lg shadow-lg focus:outline-0 focus:border-black focus:border-2" style="width:300px;" type="text">
                    </div>
                </div>
                <div class="flex flex-col mt-12 space-y-4">
                    <div class="mx-auto">Estado</div>
                    <div class="mx-auto select-none" id="profesionalStatus" onclick="toggleProfesionalStatus(this)">
                        
                    </div>
                    <div class="mx-auto text-sm">Click para cambiar</div>
                </div>
           </div>
            
        </div>
        
        <div class="grid w-full grid-cols-3 select-none">
            <div class="flex"><div class="my-auto mr-auto ml-8 px-3 py-1 rounded-lg shadow-lg bg-red-400 text-white font-medium 
                    hover:bg-red-500 transition duration-200" onclick="leaveEditUser()">Cancelar</div></div>
            <div class="flex">
                <!-- <div class="m-auto px-3 py-1 rounded-lg shadow-lg bg-blue-400 text-white font-medium 
                hover:bg-blue-500 transition duration-200">Cambiar contraseña</div> -->
            </div>
            <div class="flex"><div class="my-auto ml-auto mr-8 px-3 py-1 rounded-lg shadow-lg bg-green-400 text-white font-medium 
                hover:bg-green-500 transition duration-200" onclick="uploadProfesionalUpdate()">Aplicar</div></div>
        </div>
        
    </div>
</div>



<script>

    function toggleProfesionalStatus(element){
        if (element.innerHTML == inputActiveUserHTML) return element.innerHTML = inputDisabledUserHTML;
        element.innerHTML = inputActiveUserHTML;
    }
    
    const profesionalImage = document.getElementById("profesionalPFP");
    var loadFile = function (event) {
        
        profesionalImage.src = URL.createObjectURL(event.target.files[0]); // Se puede usar para transformar un blob en url

        const imageFile = event.target.files[0]

        resize(imageFile, 80, 80, "image/png")


        
    };
    const profesionalUsernameInput = document.getElementById("profesionalUsernameInput")
    const profesionalNombresInput = document.getElementById("profesionalNombresInput")
    const profesionalApellidosInput = document.getElementById("profesionalApellidosInput")
    const profesionalEmailInput = document.getElementById("profesionalEmailInput")
    const profesionalTelefonoInput = document.getElementById("profesionalTelefonoInput")

    async function uploadProfesionalUpdate(){
        const userID = document.getElementById("profesionalUserID").getAttribute("userID");
        const currentUser = cachedUsers.find((user) => user["ID_CUENTA"] == userID);
        const userStatus = document.getElementById("profesionalStatus").children[0].getAttribute("status");

        if(!cachedImage){
            if(currentUser["IMAGEN"]) cachedImage = currentUser["IMAGEN"];
            else{
                cachedImage = null;
            }
        } 
        
        const data = { 
            f_accountID: userID, 
            f_image: cachedImage, 
            f_username: profesionalUsernameInput.value, 
            f_nombres: profesionalNombresInput.value, 
            f_apellidos: profesionalApellidosInput.value, 
            f_email: profesionalEmailInput.value, 
            f_telefono: parseInt(profesionalTelefonoInput.value), 
            f_estado: parseInt(userStatus)
        }

        console.log(data)


        await axios({
                method: 'post',
                url: 'http://localhost:3001/editUser',
                data: data
            }).then(
                Swal.fire({
                    title: "<h5 style='color:white'>" + "Exito" + "</h5>",
                    html: "<p style='color:white'>" + "Cambios realizados exitosamente" + "</p>",
                    icon: 'success',
                    background: '#272727',
                    showCancelButton: false,
                    confirmButtonColor: '#7BCA6F',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Aceptar'
                    }).then((result) => {
                        if (result.isConfirmed) {
                            leaveEditUser()
                    }
                })
            );


    }







</script>




